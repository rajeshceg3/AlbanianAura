#controls {
    padding: 10px;
    background-color: #f2e6ff; /* Pale Lavender */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
#controls input, #controls select {
    margin-right: 10px; /* Consistent margin */
    margin-bottom: 5px; /* Add some bottom margin for stacked elements in mobile */
    padding: 8px 10px; /* Updated padding */
    border: 1px solid #d9d9d9; /* Light Grey border */
    border-radius: 5px; /* Softer corners */
    background-color: #fff; /* White background */
    transition: box-shadow 0.3s ease; /* Transition for focus */
}

#controls input:focus, #controls select:focus {
    box-shadow: 0 0 0 2px #ffd9b3; /* Soft Coral focus shadow */
    outline: none; /* Remove default outline */
}

#map {
    height: calc(100vh - 70px); /* Adjust map height considering controls, assuming controls are approx 50px + 2*10px padding */
    width: 100%;
}
body {
    margin: 0;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background-color: #e6fff2; /* Soft Mint */
    color: #4a4a4a; /* Dark Grey */
}
html, body { height: 100%; }

#itinerary {
    padding: 10px;
    background-color: #f2e6ff; /* Pale Lavender */
    margin-top: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
#itinerary h2 {
    margin-top: 0;
    margin-bottom: 10px; /* Add some space below the heading */
    font-size: 1.3em; /* Ensure consistent font size */
}
#itineraryList {
    list-style-type: none;
    padding: 0;
}
#itineraryList li {
    padding: 10px; /* Increased padding */
    border-bottom: 1px solid #e0e0e0; /* Lighter grey border */
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #fff; /* White background for items */
}
#itineraryList li:last-child {
    border-bottom: none;
}
#itineraryList button {
    padding: 5px 10px; /* Updated padding */
    background-color: #ffb3b3; /* Softer pastel red */
    color: #fff; /* White text */
    border: none;
    cursor: pointer;
    border-radius: 5px; /* Softer corners */
    transition: background-color 0.3s ease;
}
#itineraryList button:hover {
    background-color: #ff9999; /* Darker pastel red on hover */
}

#itineraryNotification {
    margin-top: 10px;
    color: #d8000c; /* Error red */
    background-color: #ffdddd; /* Light red background */
    border: 1px solid #f44336; /* Red border */
    padding: 8px; /* Adjusted padding from inline to match other elements */
    border-radius: 4px; /* Adjusted border-radius */
    text-align: center;
    /* display: none; /* Managed by JS to show/hide */
}

#langSwitcher {
    margin-top: 5px;
    margin-bottom: 5px;
    padding: 5px;
    background-color: transparent; /* Remove specific background, rely on #controls */
    border-radius: 3px;
    text-align: right; /* Align to the right of the controls bar */
    padding: 0; /* Remove padding if not needed, or adjust */
}
#langSwitcher span {
    margin-right: 5px;
    vertical-align: middle; /* Align text nicely with buttons */
}
#langSwitcher button {
    padding: 5px 10px; /* Updated padding */
    cursor: pointer;
    border: 1px solid #d9d9d9; /* Light Grey border */
    background-color: #fff; /* White background */
    color: #4a4a4a; /* Dark Grey text */
    border-radius: 5px; /* Softer corners */
    margin-left: 5px; /* Add some space between buttons */
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
#langSwitcher button:hover {
    background-color: #fff7f0; /* Lighter Soft Coral/Cream hover */
}
#langSwitcher button.activeLang { /* Style for the active language button */
    background-color: #ffd9b3; /* Soft Coral */
    color: #4a4a4a; /* Dark Grey text */
    border-color: #ffd9b3; /* Soft Coral border */
    /* Ensure transition applies to active state changes if any hover effects also apply here */
}

/* --- Responsive Design --- */

/* For smaller screens (e.g., mobile phones) */
@media (max-width: 600px) {
    #controls {
        padding: 8px; /* Slightly reduce padding */
    }

    #controls input,
    #controls select {
        display: block; /* Stack them vertically */
        width: calc(100% - 16px); /* Full width with some padding consideration */
        margin-bottom: 8px; /* Add space between stacked elements */
        margin-right: 0; /* Remove right margin */
        box-sizing: border-box; /* Ensure padding and border are included in the width */
    }

    #map {
        /* Adjust map height if controls height changes significantly.
           Assuming controls might now take up more vertical space when stacked.
           This value might need fine-tuning based on actual stacked height.
           The lang switcher might add a bit more height.
           Let's estimate a stacked controls height of around 160px now. */
        height: calc(100vh - 170px); /* Further adjust for lang switcher */
    }
    #langSwitcher {
        text-align: left; /* Align to left on mobile when controls stack */
        margin-top: 10px;
    }

    #itinerary h2 {
        font-size: 1.2em; /* Adjust heading size */
    }

    body {
        font-size: 0.95em; /* Slightly adjust base font size for small screens */
    }

    /* Ensure popups are not too wide */
    .leaflet-popup-content-wrapper {
        max-width: 80vw; /* Max width relative to viewport width */
    }
}

/* For very small screens, further adjustments if needed */
@media (max-width: 400px) {
    #controls input,
    #controls select {
        padding: 8px 5px; /* Adjust padding for very small inputs */
    }
     /* Re-evaluate map height for very small screens if controls take more space */
    #map {
         height: calc(100vh - 180px); /* Potentially adjust if controls take even more space */
    }
}

/* --- Leaflet Popup Styling --- */
.leaflet-popup-content-wrapper {
    background-color: #fff; /* White background for popup */
    color: #4a4a4a; /* Dark Grey text */
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
}

.leaflet-popup-content {
    margin: 15px; /* Ensure adequate padding inside the popup */
}

.leaflet-popup-content h3 {
    color: #4a4a4a;
    font-size: 1.15em; /* Slightly larger for title */
    margin-top: 0; /* Remove default top margin if any */
    margin-bottom: 10px; /* Space below title */
}

.leaflet-popup-content p {
    line-height: 1.6; /* Improve readability */
    margin-bottom: 10px; /* Space between paragraphs or elements */
}
.leaflet-popup-content p:last-child {
    margin-bottom: 0; /* No margin for the last paragraph */
}

.leaflet-popup-content a {
    color: #ff8c66; /* Saturated Soft Coral for links */
    text-decoration: none;
}
.leaflet-popup-content a:hover {
    text-decoration: underline;
}

.leaflet-popup-tip {
    background-color: #fff; /* Match popup body */
}

/* Adjust close button color if needed to fit the new theme */
.leaflet-popup-close-button {
    color: #777 !important; /* Important to override Leaflet's inline styles if necessary */
}
.leaflet-popup-close-button:hover {
    color: #555 !important;
}

/* "Add to Itinerary" Button in Popup */
.addToItineraryBtn {
    background-color: #ffd9b3; /* Soft Coral */
    color: #4a4a4a; /* Dark Grey text */
    border: 1px solid #ffc8a3; /* Darker Soft Coral border */
    padding: 8px 12px;
    border-radius: 5px;
    margin-top: 10px; /* Space above the button */
    cursor: pointer;
    display: inline-block; /* Ensure proper block-like behavior */
    text-align: center;
    width: calc(100% - 24px); /* Make it full width minus padding */
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
.addToItineraryBtn:hover {
    background-color: #ffc8a3; /* Darker Soft Coral on hover */
}

/* --- Review Modal Styles --- */
.modal {
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    display: flex; /* Used to center the modal content */
    align-items: center; /* Vertical centering */
    justify-content: center; /* Horizontal centering */
}

.modal-content {
    background-color: #fefefe;
    margin: auto; /* Auto margins for centering, but flexbox handles it better */
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 500px; /* Maximum width */
    border-radius: 10px;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
    position: relative; /* For positioning the close button */
}

.close-button {
    color: #aaa;
    float: right; /* Position to the top-right corner */
    font-size: 28px;
    font-weight: bold;
    position: absolute; /* Position relative to modal-content */
    top: 10px;
    right: 15px;
}

.close-button:hover,
.close-button:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

#reviewModal h3, #reviewModal h4 {
    margin-top: 0;
    color: #333;
}
#reviewModal h4 {
    margin-top: 15px;
    margin-bottom: 10px;
}

#reviewsList {
    max-height: 200px; /* Max height for review list */
    overflow-y: auto; /* Scroll for overflow */
    margin-bottom: 15px;
    border: 1px solid #eee;
    padding: 10px;
    border-radius: 5px;
}

.review-item {
    padding: 8px 0;
    border-bottom: 1px dotted #ccc;
}
.review-item:last-child {
    border-bottom: none;
}
.review-item .user-name {
    font-weight: bold;
    color: #555;
}
.review-item .rating-static {
    color: #f0ad4e; /* Star color - Bootstrap's warning yellow */
    margin-left: 5px;
}
.review-item .review-text {
    margin-top: 3px;
    font-size: 0.95em;
    color: #444;
}

#reviewForm label {
    display: block;
    margin-top: 10px;
    margin-bottom: 3px;
    font-weight: bold;
    font-size: 0.9em;
}

#reviewForm input[type="text"],
#reviewForm textarea {
    width: calc(100% - 22px); /* Full width minus padding and border */
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
}
#reviewForm textarea {
    resize: vertical;
}

#starRatingContainer {
    margin-bottom: 10px;
}
#starRatingContainer .star {
    font-size: 2em;
    color: #ddd; /* Default empty star color */
    cursor: pointer;
    padding: 0 2px; /* Spacing between stars */
}
#starRatingContainer .star.selected,
#starRatingContainer .star:hover {
    color: #f0ad4e; /* Filled star color (e.g., gold) */
}


#submitReviewBtn {
    background-color: #5cb85c; /* Green for submit */
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s ease;
}
#submitReviewBtn:hover {
    background-color: #4cae4c; /* Darker green on hover */
}

/* Popup elements for reviews */
.popup-rating-summary {
    font-size: 0.9em;
    margin-top: 8px;
    color: #555;
}
.popup-rating-summary .avg-rating-text {
    font-weight: bold;
}
.popup-rating-summary .star-icon {
    color: #f0ad4e; /* Gold star */
}

.view-reviews-btn {
    background-color: #f0ad4e; /* Orange for view reviews */
    color: white;
    border: none;
    padding: 6px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9em;
    margin-top: 5px;
    display: inline-block;
    transition: background-color 0.3s ease;
}
.view-reviews-btn:hover {
    background-color: #ec971f; /* Darker orange on hover */
}

/* Responsive adjustments for modal */
@media (max-width: 600px) {
    .modal-content {
        width: 90%; /* Wider modal on small screens */
        margin-top: 20px; /* Add some margin from top */
        margin-bottom: 20px;
        padding: 15px;
    }

    #reviewModal h3 {
        font-size: 1.2em;
    }
    #reviewModal h4 {
        font-size: 1.1em;
    }

    #reviewForm input[type="text"],
    #reviewForm textarea {
        padding: 8px;
    }

    #submitReviewBtn {
        padding: 8px 12px;
        font-size: 0.95em;
    }

    #starRatingContainer .star {
        font-size: 1.8em; /* Slightly smaller stars on mobile */
    }
}
